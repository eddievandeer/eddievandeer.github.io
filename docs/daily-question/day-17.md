---
title: Day-17 Vue给data中的对象新增属性
postTime: 2021-12-30
categories: 每日一题
tags: 
- Vue
- 面试
---
::: slot abstract

又是一次随缘更新，隔了十几天。前几天看到网易秋招补录，就顺手投了个简历，初筛筛了十几天，总算是过了，约了今天面试，然后今天的内容就和这一次的面试有关了：

~~~js
// 这是一道Vue的题目
// 假如现在data中有如下一个obj对象：
data() {
    return {
        obj: {
            a: 1,
            b: 2
        }
    }
}
// 如果给它新增一个属性c：
this.obj.c = 3
// 那么c是否具有响应式特性？若没有，怎么使他具有响应性？
~~~

由于这道题答案部分内容比较少，我会写一些面试过程中的一些经历，来 ~~水一下字数~~ 丰富一下内容

:::



## 前言

这一次网易秋招补录的面试有两个题目把我难住了，一个是这题，另一个是：

~~~
有50个请求，同一时间最多发送六个，每有一个请求完成就由下一个请求进行补位，问如何实现
~~~

我到现在都还没想明白这道题怎么做。。这里就先记录一下题目，要是哪天琢磨明白了再写一下这题的解析

> 2022-4-16 琢磨清楚了，也写在了每日一题系列里，位于 Day-26

再说一下面试的过程吧，最开始先问了我更擅长哪个框架，那自然是初恋 [Vue](https://cn.vuejs.org/) 了。然后问我对自己前端三剑客掌握情况的评价，我的回答是 CSS 和 JS 五五开，之后就是一些前端基础的考察了。这里吐槽一下，第一题问居中的实现方法，我只说了个 `flex` 的实现，面试官就没让我继续说了，直接死盯着 `flex` 问，这块内容估摸着问了有四分之一的时间，还好 `flex` 我用的多，不过也出现了知识盲区：等比例设置元素间距，到时候查查，就又能水一天的每日一题了

之后的 JS 基础部分也有不少坑，一路艰难坎坷的终于到了 Vue 框架部分的考察。上来先是生命周期，又问到了在 `v-for` 中 `key` 的作用，然后就是今天的主角了



## 题目

~~~js
// 这是一道Vue的题目
// 假如现在data中有如下一个obj对象：
data() {
    return {
        obj: {
            a: 1,
            b: 2
        }
    }
}
// 如果给它新增一个属性c：
this.obj.c = 3
// 那么c是否具有响应式特性？若没有，怎么使他具有响应性？
~~~



## 解答

Vue2 中的响应式是基于 `Object.defineProperty` 实现的， data 上定义的变量包括对象变量的属性，都是有一个 `getter` 和一个 `setter` 的，然后通过这两者去做依赖收集和发出更新视图的消息。而我们直接使用 `this.obj.c` 这样的形式为对象 `obj` 添加属性时，并没有对应 `getter` 和 `setter` 来实现视图的更新，且设置属性的响应式是在初始化数据的时候完成的，此后添加的属性不会再走一遍这个过程，因此这里新增的属性不具有响应性

要想让新增属性具有响应式，有两种解决方式：



### 赋值为一个新的对象

这里可以使用展开操作符或者 `Object.assign` 方法，来从原有的对象中复制出来一个新的对象，再向这个新对象添加属性，然后将其赋值给 `data` 中的对象，代码如下：

~~~js
// 展开操作符
this.obj = {...this.obj, c: 1}

// Object.assign
this.obj = Object.assign({}, this.obj, {c: 1})
~~~



### 使用Vue.set()方法

这是一个由 Vue 提供的 API ，可以实现往 `data` 中的对象添加新属性的功能，使用方式如下：

~~~js
// Vue构造函数上的静态方法
Vue.set(this.obj, 'c', 1)

// Vue实例上的属性方法
this.$set(this.obj, 'c', 1)
~~~

